<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- Meta, title, CSS, favicons, etc. -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Home</title>

  <!-- Bootstrap -->
  <link href="../vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <!-- NProgress -->
  <link href="../vendors/nprogress/nprogress.css" rel="stylesheet">
  <!-- iCheck -->
  <link href="../vendors/iCheck/skins/flat/green.css" rel="stylesheet">
  <!-- Datatables -->
  <link href="../vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
  <link href="../vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css" rel="stylesheet">
  <link href="../vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css" rel="stylesheet">
  <link href="../vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">
  <link href="../vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css" rel="stylesheet">

  <!-- Custom Theme Style -->
  <link href="../build/css/custom.min.css" rel="stylesheet">
  <link href="../build/css/loadingcss.css" rel="stylesheet">
</head>

<body class="nav-md">
  <div class="container body">
    <div class="main_container">
      <div class="col-md-3 left_col">
        <div class="left_col scroll-view">
          <div class="navbar nav_title" style="border: 0;">
            <a href="clients.html" class="site_title"><i class="fa"><img src="images/icon.png" height="25" width="25"></i> <span>Loja XPTO!</span></a>
          </div>

          <div class="clearfix"></div>

          <!-- /menu profile quick info -->

          <br />

          <!-- sidebar menu -->
          <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
            <div class="menu_section">
              <h3>General</h3>
              <ul class="nav side-menu">
                <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu">
                    <li><a href="index.html"><i class="fa fa-laptop"></i>Overview</a></li>
                    <li><a href="clients.html"><i class="fa fa-user"></i>Clients</a></li>
                    <li><a href="suppliers.html"><i class="fa fa-user"></i>Suppliers</a></li>
                  </ul>
                </li>
                <li><a><i class="fa fa-edit"></i> Sales <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu">
                    <li><a href="invoicelist.html"><i class="fa fa-file-text"></i>Invoice List</a></li>
                    <li><a href="orders.html"><i class="fa fa-file-text"></i>Orders</a></li>
                  </ul>
                </li>
                <li><a><i class="fa fa-group"></i> Human Resources <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu">
                      <li><a href="humanResources.html">Employees</a></li>
                  </ul>
                </li>
                <li><a><i class="fa fa-table"></i> Financial and Accounting <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu">
                    <li><a href="financial.html">Financial</a></li>
                  </ul>
                </li>
                <li><a><i class="fa fa-bar-chart-o"></i> Supply Chain <span class="fa fa-chevron-down"></span></a>
                  <ul class="nav child_menu">
                    <li><a href="produtos.html"><i class="fa fa-dropbox"></i>Products</a></li>
                  </ul>
                </li>

              </ul>
            </div>


          </div>
          <!-- /sidebar menu -->

          <!-- /menu footer buttons -->
          <div class="sidebar-footer hidden-small">
            <a data-toggle="tooltip" data-placement="top" title="Settings">
              <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
            </a>
            <a data-toggle="tooltip" data-placement="top" title="FullScreen">
              <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
            </a>
            <a data-toggle="tooltip" data-placement="top" title="Lock">
              <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
            </a>
            <a data-toggle="tooltip" data-placement="top" title="Logout">
              <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
            </a>
          </div>
          <!-- /menu footer buttons -->
        </div>
      </div>

      <!-- top navigation -->
      <div class="top_nav">
        <div class="nav_menu">
          <nav>
            <div class="nav toggle">
              <a id="menu_toggle"><i class="fa fa-bars"></i></a>
            </div>
          </nav>
        </div>
      </div>
      <!-- /top navigation -->

      <!-- page content -->
      <div class="right_col" role="main">
        <div class="">
          <div class="page-title">
            <div class="title_left">
              <h3>360º Company Dashboard. </h3>
            </div>

          </div>

          <div class="clearfix"></div>

          <div class="sk-fading-circle" id="loading">
            <div class="sk-circle1 sk-circle"></div>
            <div class="sk-circle2 sk-circle"></div>
            <div class="sk-circle3 sk-circle"></div>
            <div class="sk-circle4 sk-circle"></div>
            <div class="sk-circle5 sk-circle"></div>
            <div class="sk-circle6 sk-circle"></div>
            <div class="sk-circle7 sk-circle"></div>
            <div class="sk-circle8 sk-circle"></div>
            <div class="sk-circle9 sk-circle"></div>
            <div class="sk-circle10 sk-circle"></div>
            <div class="sk-circle11 sk-circle"></div>
            <div class="sk-circle12 sk-circle"></div>
          </div>

          <div class="row" id="hiddendiv" style="visibility:hidden">

            <div class="col-md-12 col-sm-12 col-xs-12">



              <div class="x_title">

                <div class="clearfix"></div>
              </div>
              <div class="x_content">
                <p class="text-muted font-13 m-b-30">
                  Company Overview
                </p>
                <div class="clearfix"></div>
                <div class="row">
                 <div class="col-md-12">
                   <div class="">
                     <div class="x_content">
                       <div class="row">

                         <div class="animated flipInY col-xs-4">
                           <div class="tile-stats">
                             <div class="icon"><i class="glyphicon glyphicon-bullhorn"></i>
                             </div>
                             <div class="count" id="newordersqt"></div>

                             <h3>New Orders</h3>
                             <p style="margin: 25px 0;"></p>
                           </div>
                         </div>
                         <div class="animated flipInY col-xs-4">
                           <div class="tile-stats">
                             <div class="icon"><i class="glyphicon glyphicon-dashboard"></i>
                             </div>
                             <div class="count" id="totalfa"></div>

                             <h3>Total Invoices</h3>
                             <p style="margin: 25px 0;"></p>
                           </div>
                         </div>
                         <div class="animated flipInY col-xs-4">
                           <div class="tile-stats">
                             <div class="icon"><i class="glyphicon glyphicon-fire"></i>
                             </div>
                             <div class="count" id="clientordersqt"></div>

                             <h3>Client Orders</h3>
                             <p style="margin: 25px 0;"></p>
                           </div>
                         </div>


                       </div>

                       <div class="row" style="margin: 10px 0;">
                        <div class="animated flipInY col-xs-4">
                         <div class="tile-stats" id="cenas">
                           <div class="icon"><i class="glyphicon glyphicon-upload"></i>
                           </div>
                           <div class="count" id="accountspayaqt"></div>

                           <h3>Accounts Payable</h3>
                           <p style="margin: 25px 0;"></p>
                         </div>
                       </div>
                       <div class="animated flipInY col-xs-4">
                         <div class="tile-stats">
                           <div class="icon"><i class="glyphicon glyphicon-download"></i>
                           </div>
                           <div class="count" id="accountsrecqt"></div>

                           <h3>Accounts Receivable</h3>
                           <p style="margin: 25px 0;"></p>
                         </div>
                       </div>
                       <div class="animated flipInY col-xs-4">
                         <div class="tile-stats">
                           <div class="icon"><i class="glyphicon glyphicon-user"></i>
                           </div>
                           <div class="count" id="newclientesqt"></div>

                           <h3>New Clients</h3>
                           <p style="margin: 25px 0;"></p>
                         </div>
                       </div>
                     </div>
                   </div>




                   <br />
                 </div>
               </div>
             </div>

             <div class="row">
               <div class="col-md-4">
                 <div class="x_panel">
                   <div class="x_title">
                     <h2>Top Clients</h2>
                     <ul class="nav navbar-right panel_toolbox">
                       <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                       </li>
                       <li class="dropdown">
                         <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                         <ul class="dropdown-menu" role="menu">
                           <li><a href="#">Settings 1</a>
                           </li>
                           <li><a href="#">Settings 2</a>
                           </li>
                         </ul>
                       </li>
                       <li><a class="close-link"><i class="fa fa-close"></i></a>
                       </li>
                     </ul>
                     <div class="clearfix"></div>
                   </div>
                   <div class="x_content" id="topclientswidgt">
                     <table class="table table-striped" id="topclientstable">
                       <thead>
                         <tr>
                           <th>#</th>
                           <th>Name</th>
                           <th>€</th>
                         </tr>
                       </thead>
                       <tbody>

                       </tbody>
                     </table>

                   </div>



                 </div>
               </div>
               <div class="col-md-4">
                 <div class="x_panel">
                   <div class="x_title">
                     <h2>Top Products</h2>
                     <ul class="nav navbar-right panel_toolbox">
                       <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                       </li>
                       <li class="dropdown">
                         <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                         <ul class="dropdown-menu" role="menu">
                           <li><a href="#">Settings 1</a>
                           </li>
                           <li><a href="#">Settings 2</a>
                           </li>
                         </ul>
                       </li>
                       <li><a class="close-link"><i class="fa fa-close"></i></a>
                       </li>
                     </ul>
                     <div class="clearfix"></div>
                   </div>
                   <div class="x_content" id="topclientswidgt">
                     <table class="table table-striped" id="topproductstable">
                       <thead>
                         <tr>
                           <th>#</th>
                           <th>Name</th>
                           <th>Sales Quantity</th>
                         </tr>
                       </thead>
                       <tbody>

                       </tbody>
                     </table>

                   </div>



                 </div>
               </div>
               <div class="col-md-4">
                 <div class="x_panel">
                   <div class="x_title">
                     <h2>Top Family</h2>
                     <ul class="nav navbar-right panel_toolbox">
                       <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                       </li>
                       <li class="dropdown">
                         <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                         <ul class="dropdown-menu" role="menu">
                           <li><a href="#">Settings 1</a>
                           </li>
                           <li><a href="#">Settings 2</a>
                           </li>
                         </ul>
                       </li>
                       <li><a class="close-link"><i class="fa fa-close"></i></a>
                       </li>
                     </ul>
                     <div class="clearfix"></div>
                   </div>
                   <div class="x_content" id="topclientswidgt">
                    <div id="echart_pie2" style="height:350px;"></div>

                  </div>



                </div>
              </div>
            </div>


          </div>

        </div>
      </div>
    </div>
  </div>
  <!-- /page content -->

  <!-- footer content -->
  <footer>
    <div class="pull-right">
      Gentelella - Bootstrap Admin Template by <a href="https://colorlib.com">Colorlib</a>
    </div>
    <div class="clearfix"></div>
  </footer>
  <!-- /footer content -->
</div>
</div>

<!-- jQuery -->
<script src="../vendors/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="../vendors/bootstrap/dist/js/bootstrap.min.js"></script>

<!-- FastClick -->
<script src="../vendors/fastclick/lib/fastclick.js"></script>
<!-- NProgress -->
<script src="../vendors/nprogress/nprogress.js"></script>
<!-- iCheck -->
<script src="../vendors/iCheck/icheck.min.js"></script>
<!-- Datatables -->
<script src="../vendors/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
<script src="../vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/buttons.flash.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
<script src="../vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
<script src="../vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
<script src="../vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
<script src="../vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="../vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
<script src="../vendors/datatables.net-scroller/js/datatables.scroller.min.js"></script>
<script src="../vendors/jszip/dist/jszip.min.js"></script>
<script src="../vendors/pdfmake/build/pdfmake.min.js"></script>
<script src="../vendors/pdfmake/build/vfs_fonts.js"></script>
<!-- ECharts -->
<script src="../vendors/echarts/dist/echarts.min.js"></script>


<!-- Custom Theme Scripts -->
<script src="../build/js/custom.min.js"></script>
<!-- Datatables -->
<script>
  var theme = {
    color: [
    '#26B99A', '#34495E', '#BDC3C7', '#3498DB',
    '#9B59B6', '#8abb6f', '#759c6a', '#bfd3b7'
    ],

    title: {
      itemGap: 8,
      textStyle: {
        fontWeight: 'normal',
        color: '#408829'
      }
    },

    dataRange: {
      color: ['#1f610a', '#97b58d']
    },

    toolbox: {
      color: ['#408829', '#408829', '#408829', '#408829']
    },

    tooltip: {
      backgroundColor: 'rgba(0,0,0,0.5)',
      axisPointer: {
        type: 'line',
        lineStyle: {
          color: '#408829',
          type: 'dashed'
        },
        crossStyle: {
          color: '#408829'
        },
        shadowStyle: {
          color: 'rgba(200,200,200,0.3)'
        }
      }
    },

    dataZoom: {
      dataBackgroundColor: '#eee',
      fillerColor: 'rgba(64,136,41,0.2)',
      handleColor: '#408829'
    },
    grid: {
      borderWidth: 0
    },

    categoryAxis: {
      axisLine: {
        lineStyle: {
          color: '#408829'
        }
      },
      splitLine: {
        lineStyle: {
          color: ['#eee']
        }
      }
    },

    valueAxis: {
      axisLine: {
        lineStyle: {
          color: '#408829'
        }
      },
      splitArea: {
        show: true,
        areaStyle: {
          color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.1)']
        }
      },
      splitLine: {
        lineStyle: {
          color: ['#eee']
        }
      }
    },
    timeline: {
      lineStyle: {
        color: '#408829'
      },
      controlStyle: {
        normal: {color: '#408829'},
        emphasis: {color: '#408829'}
      }
    },

    k: {
      itemStyle: {
        normal: {
          color: '#68a54a',
          color0: '#a9cba2',
          lineStyle: {
            width: 1,
            color: '#408829',
            color0: '#86b379'
          }
        }
      }
    },
    map: {
      itemStyle: {
        normal: {
          areaStyle: {
            color: '#ddd'
          },
          label: {
            textStyle: {
              color: '#c12e34'
            }
          }
        },
        emphasis: {
          areaStyle: {
            color: '#99d2dd'
          },
          label: {
            textStyle: {
              color: '#c12e34'
            }
          }
        }
      }
    },
    force: {
      itemStyle: {
        normal: {
          linkStyle: {
            strokeColor: '#408829'
          }
        }
      }
    },
    chord: {
      padding: 4,
      itemStyle: {
        normal: {
          lineStyle: {
            width: 1,
            color: 'rgba(128, 128, 128, 0.5)'
          },
          chordStyle: {
            lineStyle: {
              width: 1,
              color: 'rgba(128, 128, 128, 0.5)'
            }
          }
        },
        emphasis: {
          lineStyle: {
            width: 1,
            color: 'rgba(128, 128, 128, 0.5)'
          },
          chordStyle: {
            lineStyle: {
              width: 1,
              color: 'rgba(128, 128, 128, 0.5)'
            }
          }
        }
      }
    },
    gauge: {
      startAngle: 225,
      endAngle: -45,
      axisLine: {
        show: true,
        lineStyle: {
          color: [[0.2, '#86b379'], [0.8, '#68a54a'], [1, '#408829']],
          width: 8
        }
      },
      axisTick: {
        splitNumber: 10,
        length: 12,
        lineStyle: {
          color: 'auto'
        }
      },
      axisLabel: {
        textStyle: {
          color: 'auto'
        }
      },
      splitLine: {
        length: 18,
        lineStyle: {
          color: 'auto'
        }
      },
      pointer: {
        length: '90%',
        color: 'auto'
      },
      title: {
        textStyle: {
          color: '#333'
        }
      },
      detail: {
        textStyle: {
          color: 'auto'
        }
      }
    },
    textStyle: {
      fontFamily: 'Arial, Verdana, sans-serif'
    }
  };

  $(document).ready(function() {


    function kFormatter(num) {
     if(num > 999999999 || num < -999999999 )
      return (num/1000000000).toFixed(1) + 'B';
    else if(num > 999999 || num < -999999)
      return (num/1000000).toFixed(1) + 'M';
    else if(num > 999 || num < -999)
      return (num/1000).toFixed(1) + 'K';
    else return num;
  }

 $.ajax({
  url: 'http://localhost:49822/api/Dashboard',
  dataType: "json",
  success : function(data, textStatus, jqXHR) {

    $('#newclientesqt').text(data[0].NewClients);
    $('#accountspayaqt').text(kFormatter(data[0].AccountsPayable));
    $('#accountsrecqt').text(kFormatter(data[0].AccountsReceivable));
    $('#clientordersqt').text(data[0].Orders);
    $('#newordersqt').text(data[0].newOrders);
    $('#totalfa').text(data[0].CountFac);

    for (i = 0; i < data[0].TopClientes.length; i++) {
      data[0].TopClientes[i].RendimentoCliente = kFormatter(data[0].TopClientes[i].RendimentoCliente);

    }

    $("#topclientstable").DataTable({
      "bPaginate": false,
      "bFilter": false,
      "bInfo": false,
      "paging":   false,
      "ordering": false,
      "info":     false,
      "data": data[0].TopClientes,
      "columns" : [ {
        "data" : "Numbercnt"
      },{
        "data" : "NomeCliente"
      }, {
        "data" :  "RendimentoCliente"
      }
      ]

    });

    $("#topproductstable").DataTable({
      "bPaginate": false,
      "bFilter": false,
      "bInfo": false,
      "paging":   false,
      "ordering": false,
      "info":     false,
      "data": data[0].TopProducts,
      "columns" : [ {
        "data" : "Numbercnt"
      },{
        "data" : "NomeArtigo"
      }, {
        "data" :  "QuantidadeArtigo"
      }
      ]

    });





    var echartPieCollapse = echarts.init(document.getElementById('echart_pie2'), theme);

    echartPieCollapse.setOption({
      tooltip: {
        trigger: 'item',
        formatter: "{a} <br/>{b} : {c} ({d}%)"
      },
      legend: {
        x: 'center',
        y: 'bottom',
        data: [data[0].TopFamilia[0].Descricao, data[0].TopFamilia[1].Descricao, data[0].TopFamilia[2].Descricao, data[0].TopFamilia[3].Descricao, data[0].TopFamilia[4].Descricao, data[0].TopFamilia[5].Descricao]
      },
      toolbox: {
        show: true,
        feature: {
          magicType: {
            show: true,
            type: ['pie', 'funnel']
          },
          restore: {
            show: true,
            title: "Restore"
          },
          saveAsImage: {
            show: true,
            title: "Save Image"
          }
        }
      },
      calculable: true,
      series: [{
        name: 'Area Mode',
        type: 'pie',
        radius: [25, 90],
        center: ['50%', 170],
        roseType: 'area',
        x: '50%',
        max: 40,
        sort: 'ascending',
        data: [{
          value: data[0].TopFamilia[0].TotalVend,
          name: data[0].TopFamilia[0].Descricao,
        }, {
          value: data[0].TopFamilia[1].TotalVend,
          name: data[0].TopFamilia[1].Descricao
        }, {
          value: data[0].TopFamilia[2].TotalVend,
          name: data[0].TopFamilia[2].Descricao
        }, {
          value: data[0].TopFamilia[3].TotalVend,
          name: data[0].TopFamilia[3].Descricao
        }, {
          value: data[0].TopFamilia[4].TotalVend,
          name: data[0].TopFamilia[4].Descricao
        }, {
          value: data[0].TopFamilia[5].TotalVend,
          name: data[0].TopFamilia[5].Descricao
        }]
      }]
    });


    $('#loading').css("display", "none");
    $('#hiddendiv').css("visibility", "visible");
    $('#loading').css("display", "none");
    $('#hiddendiv').css("visibility", "visible");
  }
});


 var handleDataTableButtons = function() {
  if ($("#datatable-buttons").length) {
    $("#datatable-buttons").DataTable({
      dom: "Bfrtip",
      buttons: [
      {
        extend: "copy",
        className: "btn-sm"
      },
      {
        extend: "csv",
        className: "btn-sm"
      },
      {
        extend: "excel",
        className: "btn-sm"
      },
      {
        extend: "pdfHtml5",
        className: "btn-sm"
      },
      {
        extend: "print",
        className: "btn-sm"
      },
      ],
      responsive: true
    });
  }
};

TableManageButtons = function() {
  "use strict";
  return {
    init: function() {
      handleDataTableButtons();
    }
  };
}();



$('#datatable-keytable').DataTable({
  keys: true
});



$('#datatable-scroller').DataTable({
  ajax: "js/datatables/json/scroller-demo.json",
  deferRender: true,
  scrollY: 380,
  scrollCollapse: true,
  scroller: true
});

$('#datatable-fixed-header').DataTable({
  fixedHeader: true
});

var $datatable = $('#datatable-checkbox');

$datatable.dataTable({
  'order': [[ 1, 'asc' ]],
  'columnDefs': [
  { orderable: false, targets: [0] }
  ]
});
$datatable.on('draw.dt', function() {
  $('input').iCheck({
    checkboxClass: 'icheckbox_flat-green'
  });
});

TableManageButtons.init();

});
</script>
<!-- /Datatables -->
</body>
</html>
